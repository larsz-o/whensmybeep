(window.webpackJsonp=window.webpackJsonp||[]).push([[0],{231:function(e,t,a){e.exports=a(413)},241:function(e,t,a){},413:function(e,t,a){"use strict";a.r(t);var n=a(0),r=a.n(n),s=a(24),o=a.n(s),i=a(36),c=a(37),l=a(159),u=(a(240),a(28)),m={FETCH_USER:"FETCH_USER",SET_USER:"SET_USER_ACTION",UNSET_USER:"UNSET_USER_ACTION",REQUEST_START:"REQUEST_START_USER_ACTION",REQUEST_DONE:"REQUEST_DONE_USER_ACTION",LOGOUT:"LOGOUT",USER_FETCH_FAILED:"USER_FETCH_FAILED"},p=Object(i.c)({id:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case m.SET_USER:return t.user.id||e;case m.UNSET_USER:return null;default:return e}},userName:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case m.SET_USER:return t.user.username||e;case m.UNSET_USER:return null;default:return e}},isLoading:function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];switch((arguments.length>1?arguments[1]:void 0).type){case m.REQUEST_START:return!0;case m.REQUEST_DONE:return!1;default:return e}}}),d={LOGIN:"LOGIN",CLEAR_LOGIN_ERROR:"CLEAR_LOGIN_ERROR",REQUEST_START:"REQUEST_START",LOGIN_REQUEST_DONE:"LOGIN_REQUEST_DONE",LOGIN_FAILED:"LOGIN_FAILED",LOGIN_FAILED_NO_CODE:"LOGIN_FAILED_NO_CODE",INPUT_ERROR:"INPUT_ERROR",LOGOUT:"LOGOUT"},h=function(e,t){return{type:d.LOGIN,payload:{username:e,password:t}}},E=function(){return{type:d.LOGOUT}};var f=Object(i.c)({isLoading:function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];switch((arguments.length>1?arguments[1]:void 0).type){case d.REQUEST_START:return!0;case d.REQUEST_DONE:return!1;default:return e}},message:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"",t=arguments.length>1?arguments[1]:void 0;switch(t.type){case d.CLEAR_LOGIN_ERROR:return"";case d.LOGIN_FAILED:return"Ooops! The username and password didn't match. Try again!";case d.LOGIN_FAILED_NO_CODE:return"Ooops! Something went wrong! Is the server running?";case d.INPUT_ERROR:return t.payload;default:return e}}}),g=Object(i.c)({user:p,login:f}),O=a(20),v=a(21),b=a(34),T=a(22),_=a(35),w=(a(241),a(415)),y=a(417),S=a(416),R=a(418),N=a(43),j=a(6),C=a(45),x=a(19),D=a.n(x),U=a(104),L=a.n(U),I=function(e){function t(e){var a;return Object(O.a)(this,t),(a=Object(b.a)(this,Object(T.a)(t).call(this,e))).calculateTime=function(){var e=(new Date).getTime(),t=a.state.countDownDate-e;if(t>0){var n=Math.floor(t/864e5),r=Math.floor(t%864e5/36e5),s=Math.floor(t%36e5/6e4),o=Math.floor(t%6e4/1e3);a.setState(Object(C.a)({},a.state,{days:n,hours:r,minutes:s,seconds:o})),t<=500?a.stopTimer():t<3e5?a.setState(Object(C.a)({},a.state,{warning:"warning"})):t>3e5&&a.setState(Object(C.a)({},a.state,{warning:"none"}))}else a.stopTimer()},a.deleteMed=function(){D()({method:"DELETE",url:"/medlist?id=".concat(a.props.med.id)}).then(function(e){a.props.getMedLists()}).catch(function(e){console.log("Error deleting medication",e)})},a.getTimerData=function(){console.log("in get timer data",a.props.med.id),D()({method:"GET",url:"/medlist/countdown?id=".concat(a.props.med.id)}).then(function(e){console.log(e);var t=(new Date).getTime();a.timer=setInterval(a.calculateTime,1e3),a.setState(Object(C.a)({},a.state,{countDownDate:parseInt(e.data[0].time_end,10),expiration_time:e.data[0].expiration_time})),e.data[0].time_end-t<=0&&(console.log("in stopTimer"),clearInterval(a.timer))}).catch(function(e){console.log("Error getting current data",e)})},a.handleChangeStart=function(){console.log("start clicked");var e=new Date,t=L()(e).format("YYYY-MM-DDTHH:mm:ss");a.setState(Object(C.a)({},a.state,{open:!0,warning:"none",defaultDate:t,expiration_time:t,expired:"false"}))},a.handleClose=function(){a.setState(Object(C.a)({},a.state,{open:!1})),a.updateDatabase()},a.stopTimer=function(){console.log("in stopTimer"),clearInterval(a.timer);(new Date).getTime();D()({method:"PUT",url:"/medlist",data:{time_end:0,id:a.props.med.id,expired:!0,expiration_time:a.state.expiration_time}}).then(function(e){a.setState(Object(C.a)({},a.state,{hours:0,minutes:0,seconds:0,expired:"true"})),a.props.getMedLists()}).catch(function(e){console.log("Error posting countdown time to server",e)})},a.updateDatabase=function(){console.log("in update database for med:",a.props.med.id,"new time:",a.state.countDownDate),D()({method:"PUT",url:"/medlist",data:{time_end:a.state.countDownDate,id:a.props.med.id,expired:!1,expiration_time:a.state.expiration_time}}).then(function(e){a.getTimerData()}).catch(function(e){console.log("Error posting countdown time to server",e)})},a.handleInputChange=function(e){var t=e.target.value,n=new Date(t).getTime();a.setState({countDownDate:n,expiration_time:t})},a.state={countDownDate:1,open:!1,days:0,hours:0,minutes:0,seconds:0,warning:"none",defaultDate:"",expiration_time:a.props.med.expiration_time,expired:"false"},a}return Object(_.a)(t,e),Object(v.a)(t,[{key:"componentDidMount",value:function(){this.getTimerData()}},{key:"render",value:function(){return r.a.createElement(j.n,{className:this.state.warning},r.a.createElement(j.l,{className:this.state.expired},this.props.med.room_id),r.a.createElement(j.l,{className:this.state.expired},this.props.med.name),r.a.createElement(j.l,{className:this.state.expired},this.state.hours," h ",this.state.minutes," m ",this.state.seconds," s"),"N/A"!==this.state.expiration_time&&r.a.createElement(j.l,{className:this.state.expired},L()(this.state.expiration_time).format("LTS")),"N/A"===this.state.expiration_time&&r.a.createElement(j.l,{className:this.expired},"N/A"),r.a.createElement(j.l,{className:this.state.expired},r.a.createElement(j.a,{variant:"contained",color:"primary",onClick:this.handleChangeStart},"Start")),r.a.createElement(j.b,{open:this.state.open,onClose:this.handleClose,"aria-labelledby":"form-dialog-title"},r.a.createElement(j.e,{id:"form-dialog-title"},"Set End Time"),r.a.createElement(j.d,null,r.a.createElement(j.o,{id:"datetime-local",type:"datetime-local",defaultValue:this.state.defaultDate,onChange:this.handleInputChange})),r.a.createElement(j.c,null,r.a.createElement(j.a,{variant:"contained",color:"primary",onClick:this.handleClose},"Submit"))),r.a.createElement(j.l,{className:this.state.expired},r.a.createElement(j.a,{variant:"contained",color:"secondary",onClick:this.deleteMed},"Delete")))}}]),t}(n.Component),A=function(e){function t(){var e;return Object(O.a)(this,t),(e=Object(b.a)(this,Object(T.a)(t).call(this))).componentDidMount=function(){e.props.dispatch({type:m.FETCH_USER}),e.getMedLists()},e.getMedLists=function(){console.log("in get medlist"),D()({method:"GET",url:"/medlist"}).then(function(t){console.log(t.data),e.setState({medList:t.data})}).catch(function(e){console.log("Error",e)})},e.handleInputChange=function(t,a){console.log(t.target.value),e.setState(Object(N.a)({},a,t.target.value))},e.logout=function(){e.props.dispatch(E())},e.postMedication=function(){D()({method:"POST",url:"/medlist",data:{name:e.state.name,room_id:e.state.room,expiration_time:"N/A"}}).then(function(t){e.getMedLists(),e.setState({name:"",room:20})}).catch(function(e){console.log("Error posting your lists, please try again",e),alert("Error posting your lists to the server. Please try again")})},e.state={room:20,name:"",medList:[],defaultDate:""},e}return Object(_.a)(t,e),Object(v.a)(t,[{key:"componentDidUpdate",value:function(){this.props.user.isLoading||null!==this.props.user.userName||this.props.history.push("/login")}},{key:"render",value:function(){var e=this;return r.a.createElement("div",null,r.a.createElement(j.a,{color:"secondary",variant:"contained",className:"float-right",onClick:this.logout},"Log Out"),r.a.createElement("div",{className:"flex-box"},r.a.createElement("label",null,"Room # (required): "),r.a.createElement(j.h,{value:this.state.room,label:"Room Number",onChange:function(t){return e.handleInputChange(t,"room")},inputProps:{name:"room",id:"select-menu"}},r.a.createElement("option",{value:20},"20"),r.a.createElement("option",{value:21},"21"),r.a.createElement("option",{value:22},"22"),r.a.createElement("option",{value:23},"23"),r.a.createElement("option",{value:24},"24"),r.a.createElement("option",{value:25},"25"),r.a.createElement("option",{value:28},"28"),r.a.createElement("option",{value:29},"29"),r.a.createElement("option",{value:30},"30"),r.a.createElement("option",{value:31},"31"),r.a.createElement("option",{value:32},"32"),r.a.createElement("option",{value:33},"33"),r.a.createElement("option",{value:34},"34"),r.a.createElement("option",{value:35},"35"),r.a.createElement("option",{value:36},"36"),r.a.createElement("option",{value:37},"37"),r.a.createElement("option",{value:38},"38"),r.a.createElement("option",{value:39},"39"),r.a.createElement("option",{value:41},"41"),r.a.createElement("option",{value:42},"42"),r.a.createElement("option",{value:43},"43"),r.a.createElement("option",{value:44},"44"),r.a.createElement("option",{value:45},"45"),r.a.createElement("option",{value:46},"46"))),r.a.createElement("div",{className:"flex-box"},r.a.createElement("label",null,"Drug Name (required): "),r.a.createElement(j.o,{value:this.state.name,id:"med-input",onChange:function(t){return e.handleInputChange(t,"name")},required:!0}),r.a.createElement(j.a,{variant:"contained",className:"submit-btn",color:"primary",onClick:this.postMedication},"Submit")),r.a.createElement(j.i,null,r.a.createElement(j.j,{id:"table"},r.a.createElement(j.m,null,r.a.createElement(j.n,null,r.a.createElement(j.l,null,"Room Number"),r.a.createElement(j.l,null,"Medication Name"),r.a.createElement(j.l,null,"Time Until Next Beep"),r.a.createElement(j.l,null,"Expiration"),r.a.createElement(j.l,null,"Start"),r.a.createElement(j.l,null,"Delete"))),r.a.createElement(j.k,null,this.state.medList.map(function(t,a){return r.a.createElement(I,{getMedLists:e.getMedLists,key:a,med:t})})))))}}]),t}(n.Component),k=Object(c.b)(function(e){return{user:e.user,login:e.login}})(A),F=function(e){function t(){return Object(O.a)(this,t),Object(b.a)(this,Object(T.a)(t).apply(this,arguments))}return Object(_.a)(t,e),Object(v.a)(t,[{key:"render",value:function(){return r.a.createElement("header",{className:"App-header"},r.a.createElement("h2",{className:"App-title"},"When's My Beep?"))}}]),t}(n.Component),G=Object(c.b)(function(e){return{user:e.user}})(F),M=function(e){function t(){return Object(O.a)(this,t),Object(b.a)(this,Object(T.a)(t).apply(this,arguments))}return Object(_.a)(t,e),Object(v.a)(t,[{key:"componentDidMount",value:function(){this.props.dispatch({type:m.FETCH_USER})}},{key:"componentDidUpdate",value:function(){this.props.user.isLoading||null!==this.props.user.userName||this.props.history.push("/login")}},{key:"render",value:function(){return r.a.createElement("div",null,r.a.createElement(k,{history:this.props.history}))}}]),t}(n.Component),Q=Object(c.b)(function(e){return{user:e.user}})(M),H=a(414),P=function(e){function t(e){var a;return Object(O.a)(this,t),(a=Object(b.a)(this,Object(T.a)(t).call(this,e))).login=function(e){e.preventDefault(),""===a.state.username||""===a.state.password?a.props.dispatch({type:d.INPUT_ERROR,payload:"Enter your username and password!"}):a.props.dispatch(h(a.state.username,a.state.password))},a.handleInputChangeFor=function(e){return function(t){a.setState(Object(N.a)({},e,t.target.value))}},a.state={username:"",password:""},a}return Object(_.a)(t,e),Object(v.a)(t,[{key:"componentDidMount",value:function(){this.props.dispatch({type:m.FETCH_USER}),this.props.dispatch({type:d.CLEAR_LOGIN_ERROR})}},{key:"componentDidUpdate",value:function(){this.props.user.isLoading||null===this.props.user.userName||this.props.history.push("/home")}},{key:"renderAlert",value:function(){return""!==this.props.login.message?r.a.createElement("h2",{className:"alert",role:"alert"},this.props.login.message):r.a.createElement("span",null)}},{key:"render",value:function(){return r.a.createElement("div",null,this.renderAlert(),r.a.createElement("div",{className:"flex-box-form"},r.a.createElement("form",{onSubmit:this.login},r.a.createElement("h1",null,"When's My Beep?"),r.a.createElement("h1",null,"Login"),r.a.createElement("div",null,r.a.createElement("label",{htmlFor:"username"},"Username:",r.a.createElement("input",{type:"text",name:"username",value:this.state.username,onChange:this.handleInputChangeFor("username")}))),r.a.createElement("div",null,r.a.createElement("label",{htmlFor:"password"},"Password:",r.a.createElement("input",{type:"password",name:"password",value:this.state.password,onChange:this.handleInputChangeFor("password")}))),r.a.createElement("div",null,r.a.createElement(j.a,{variant:"contained",color:"primary",type:"submit",name:"submit",value:"Log In"},"Submit"),r.a.createElement(H.a,{to:"/register"},"Register")))))}}]),t}(n.Component),B=Object(c.b)(function(e){return{user:e.user,login:e.login}})(P),Y=a(158),q=a.n(Y),V=function(e){function t(e){var a;return Object(O.a)(this,t),(a=Object(b.a)(this,Object(T.a)(t).call(this,e))).registerUser=function(e){if(e.preventDefault(),e.preventDefault(),a.passwordConfirmationAlert())if(""===a.state.username||""===a.state.password)a.setState({message:"Choose a username and password!"});else{var t={username:a.state.username,password:a.state.password};D.a.post("/api/user/register/",t).then(function(e){201===e.status?a.props.history.push("/home"):a.setState({message:"Ooops! That didn't work. The username might already be taken. Try again!"})}).catch(function(){a.setState({message:"Ooops! Something went wrong! Is the server running?"})})}},a.handleInputChangeFor=function(e){return function(t){a.setState(Object(N.a)({},e,t.target.value))}},a.passwordConfirmationAlert=function(){return a.state.password===a.state.confirm_password||(q()("Oh no!","Entered passwords do not match! Try again.","warning"),!1)},a.state={username:"",password:"",message:""},a}return Object(_.a)(t,e),Object(v.a)(t,[{key:"renderAlert",value:function(){return""!==this.state.message?r.a.createElement(j.p,{variant:"headline",className:"alert",role:"alert"},this.state.message):r.a.createElement("span",null)}},{key:"render",value:function(){return r.a.createElement("div",{className:"flex-box-form"},this.renderAlert(),r.a.createElement("form",null,r.a.createElement(j.p,{variant:"headline"},"Create Account"),r.a.createElement("div",null,r.a.createElement(j.g,{htmlFor:"username"}),"Username:",r.a.createElement(j.f,{type:"text",name:"username",value:this.state.username,onChange:this.handleInputChangeFor("username")})),r.a.createElement("div",null,r.a.createElement(j.g,{htmlFor:"password"}),"Password:",r.a.createElement(j.f,{type:"password",name:"password",value:this.state.password,onChange:this.handleInputChangeFor("password")}),r.a.createElement("br",null),r.a.createElement(j.g,{htmlFor:"confirm-password"}),"Confirm Password:",r.a.createElement(j.f,{type:"password",name:"confirm-password",value:this.state.confirm_password,onChange:this.handleInputChangeFor("confirm_password"),required:!0})),r.a.createElement("div",null,r.a.createElement(j.a,{onClick:this.registerUser},"Submit"),r.a.createElement(H.a,{to:"/home"},"Cancel"))))}}]),t}(n.Component),J=function(e){function t(){return Object(O.a)(this,t),Object(b.a)(this,Object(T.a)(t).apply(this,arguments))}return Object(_.a)(t,e),Object(v.a)(t,[{key:"render",value:function(){return r.a.createElement(w.a,null,r.a.createElement(y.a,null,r.a.createElement(S.a,{exact:!0,from:"/",to:"/login"}),r.a.createElement(R.a,{path:"/login",component:B}),r.a.createElement(R.a,{path:"/register",component:V}),r.a.createElement("div",{className:"App"},r.a.createElement(G,null),r.a.createElement(R.a,{path:"/home",component:Q}),r.a.createElement(R.a,{path:"/dashboard",component:k})),r.a.createElement(R.a,{render:function(){return r.a.createElement("h1",null,"404")}})))}}]),t}(n.Component),W=a(33),K=a.n(W),z=a(30);var X=K.a.mark($),Z=K.a.mark(ee);function $(){var e;return K.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,Object(z.b)({type:m.REQUEST_START});case 3:return t.next=5,D.a.get("api/user",{headers:{"Content-Type":"application/json"},withCredentials:!0}).then(function(e){return e.data}).catch(function(e){throw e.response||e});case 5:return e=t.sent,t.next=8,Object(z.b)({type:m.SET_USER,user:e});case 8:return t.next=10,Object(z.b)({type:m.REQUEST_DONE});case 10:t.next=18;break;case 12:return t.prev=12,t.t0=t.catch(0),t.next=16,Object(z.b)({type:m.REQUEST_DONE});case 16:return t.next=18,Object(z.b)({type:m.USER_FETCH_FAILED,message:t.t0.data||"FORBIDDEN"});case 18:case"end":return t.stop()}},X,this,[[0,12]])}function ee(){return K.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Object(z.c)(m.FETCH_USER,$);case 2:case"end":return e.stop()}},Z,this)}var te=ee;function ae(e){var t={username:e.username,password:e.password};return D.a.post("api/user/login",t,{headers:{"Content-Type":"application/json"},withCredentials:!0}).then(function(e){return e.data}).catch(function(e){throw e.response||e})}var ne=K.a.mark(oe),re=K.a.mark(ie),se=K.a.mark(ce);function oe(e){return K.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,Object(z.b)({type:d.CLEAR_LOGIN_ERROR});case 3:return t.next=5,Object(z.b)({type:d.REQUEST_START});case 5:return t.next=7,ae(e.payload);case 7:return t.next=9,Object(z.b)({type:d.LOGIN_REQUEST_DONE});case 9:return t.next=11,Object(z.b)({type:m.FETCH_USER});case 11:t.next=24;break;case 13:return t.prev=13,t.t0=t.catch(0),t.next=17,Object(z.b)({type:d.LOGIN_REQUEST_DONE});case 17:if(401!==t.t0.status){t.next=22;break}return t.next=20,Object(z.b)({type:d.LOGIN_FAILED,message:t.t0.message});case 20:t.next=24;break;case 22:return t.next=24,Object(z.b)({type:d.LOGIN_FAILED_NO_CODE,message:t.t0.message});case 24:case"end":return t.stop()}},ne,this,[[0,13]])}function ie(e){return K.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,D.a.get("api/user/logout",{headers:{"Content-Type":"application/json"},withCredentials:!0}).then(function(e){return e.data}).catch(function(e){throw e.response||e});case 3:return e.next=5,Object(z.b)({type:m.UNSET_USER});case 5:e.next=10;break;case 7:e.prev=7,e.t0=e.catch(0),console.log("LOGOUT FAILED -- CHECK YOUR SERVER",e.t0);case 10:case"end":return e.stop()}},re,this,[[0,7]])}function ce(){return K.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Object(z.c)(d.LOGIN,oe);case 2:return e.next=4,Object(z.c)(d.LOGOUT,ie);case 4:case"end":return e.stop()}},se,this)}var le=ce,ue=K.a.mark(me);function me(){return K.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Object(z.a)([te(),le()]);case 2:case"end":return e.stop()}},ue,this)}var pe=[],de=Object(l.a)();pe.push(de);var he=Object(u.createMuiTheme)({typography:{useNextVariants:!0},palette:{primary:{main:"#47b8e0"},secondary:{main:"#34314c"}}}),Ee=Object(i.d)(g,{},i.a.apply(void 0,pe));de.run(me),o.a.render(r.a.createElement(c.a,{store:Ee},r.a.createElement(u.MuiThemeProvider,{theme:he},r.a.createElement(J,null))),document.getElementById("react-root"))}},[[231,2,1]]]);
//# sourceMappingURL=main.b56a5049.chunk.js.map